version: "3"
services:

 django:
  build:
   context: ./
  volumes:
   - ./django/:/app
   - ./django_datatables/:/dt/django_datatables
   - /var/run/docker.sock:/var/run/docker.sock
  command: bash -c "python manage.py migrate && python manage.py import_data && python manage.py runserver 0.0.0.0:8006"
  environment:
   - PYTHONPATH=/dt
  ports:
   - 8006:8006
  depends_on:
   - db

 db:
  image: postgres:13.0-alpine
  volumes:
    - ./data/db:/var/lib/postgresql/data
  environment:
    - POSTGRES_USER=django_datatables
    - POSTGRES_PASSWORD=django_datatables
    - POSTGRES_DB=django_datatables


